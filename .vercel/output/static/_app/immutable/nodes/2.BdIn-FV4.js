import{y as Le,t as Ye,f as Ie,s as Xt,z as Zt,n as ct,r as Qt,o as en,c as dt}from"../chunks/scheduler.uoSMR5Ut.js";import{S as tn,i as nn,e as R,s as fe,t as ve,c as V,a as ee,m as Re,f as ce,b as _e,d as U,n as M,g as Ue,h as S,z as mt,A as rn,j as We,B as an}from"../chunks/index.C5qq0cey.js";import{e as pt}from"../chunks/each.Aa86rT4B.js";import{g as sn}from"../chunks/ProgressBar.svelte_svelte_type_style_lang.BUHJqjdN.js";import{U as kt,N as on,P as un,a as ln,b as Ft,H as fn,p as cn,i as It,c as Ve,d as dn,g as mn}from"../chunks/entry.VIbE_Nhl.js";import{d as et,w as oe,a as ze}from"../chunks/index.DJ8iOWEq.js";import{p as Oe,n as ht}from"../chunks/stores.C6SO5lWG.js";const pn=!0;class Ge extends Error{constructor(r,i){super(r),this.name="DevalueError",this.path=i.join("")}}function yt(n){return Object(n)!==n}const hn=Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function yn(n){const r=Object.getPrototypeOf(n);return r===Object.prototype||r===null||Object.getOwnPropertyNames(r).sort().join("\0")===hn}function gn(n){return Object.prototype.toString.call(n).slice(8,-1)}function bn(n){switch(n){case'"':return'\\"';case"<":return"\\u003C";case"\\":return"\\\\";case`
`:return"\\n";case"\r":return"\\r";case"	":return"\\t";case"\b":return"\\b";case"\f":return"\\f";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return n<" "?`\\u${n.charCodeAt(0).toString(16).padStart(4,"0")}`:""}}function Ae(n){let r="",i=0;const t=n.length;for(let u=0;u<t;u+=1){const o=n[u],s=bn(o);s&&(r+=n.slice(i,u)+s,i=u+1)}return`"${i===0?n:r+n.slice(i)}"`}function vn(n){return Object.getOwnPropertySymbols(n).filter(r=>Object.getOwnPropertyDescriptor(n,r).enumerable)}function _n(n,r){const i=[],t=new Map,u=[];for(const c in r)u.push({key:c,fn:r[c]});const o=[];let s=0;function f(c){if(typeof c=="function")throw new Ge("Cannot stringify a function",o);if(t.has(c))return t.get(c);if(c===void 0)return kt;if(Number.isNaN(c))return on;if(c===1/0)return un;if(c===-1/0)return ln;if(c===0&&1/c<0)return Ft;const p=s++;t.set(c,p);for(const{key:b,fn:A}of u){const P=A(c);if(P)return i[p]=`["${b}",${f(P)}]`,p}let h="";if(yt(c))h=Je(c);else switch(gn(c)){case"Number":case"String":case"Boolean":h=`["Object",${Je(c)}]`;break;case"BigInt":h=`["BigInt",${c}]`;break;case"Date":h=`["Date","${!isNaN(c.getDate())?c.toISOString():""}"]`;break;case"RegExp":const{source:P,flags:I}=c;h=I?`["RegExp",${Ae(P)},"${I}"]`:`["RegExp",${Ae(P)}]`;break;case"Array":h="[";for(let g=0;g<c.length;g+=1)g>0&&(h+=","),g in c?(o.push(`[${g}]`),h+=f(c[g]),o.pop()):h+=fn;h+="]";break;case"Set":h='["Set"';for(const g of c)h+=`,${f(g)}`;h+="]";break;case"Map":h='["Map"';for(const[g,O]of c)o.push(`.get(${yt(g)?Je(g):"..."})`),h+=`,${f(g)},${f(O)}`,o.pop();h+="]";break;default:if(!yn(c))throw new Ge("Cannot stringify arbitrary non-POJOs",o);if(vn(c).length>0)throw new Ge("Cannot stringify POJOs with symbolic keys",o);if(Object.getPrototypeOf(c)===null){h='["null"';for(const g in c)o.push(`.${g}`),h+=`,${Ae(g)},${f(c[g])}`,o.pop();h+="]"}else{h="{";let g=!1;for(const O in c)g&&(h+=","),g=!0,o.push(`.${O}`),h+=`${Ae(O)}:${f(c[O])}`,o.pop();h+="}"}}return i[p]=h,p}const m=f(n);return m<0?`${m}`:`[${i.join(",")}]`}function Je(n){const r=typeof n;return r==="string"?Ae(n):n instanceof String?Ae(n.toString()):n===void 0?kt.toString():n===0&&1/n<0?Ft.toString():r==="bigint"?`["BigInt","${n}"]`:String(n)}const Ot=pn;function Ke(n,r,i){return n[r]=i,"skip"}function En(n,r){return r.value!==void 0&&typeof r.value!="object"&&r.path.length<n.length}function ge(n,r,i={}){i.modifier||(i.modifier=u=>En(r,u)?void 0:u.value);const t=de(n,r,i.modifier);if(t)return i.value===void 0||i.value(t.value)?t:void 0}function de(n,r,i){if(!r.length)return;const t=[r[0]];let u=n;for(;u&&t.length<r.length;){const s=t[t.length-1],f=i?i({parent:u,key:String(s),value:u[s],path:t.map(m=>String(m)),isLeaf:!1,set:m=>Ke(u,s,m)}):u[s];if(f===void 0)return;u=f,t.push(r[t.length])}if(!u)return;const o=r[r.length-1];return{parent:u,key:String(o),value:u[o],path:r.map(s=>String(s)),isLeaf:!0,set:s=>Ke(u,o,s)}}function he(n,r,i=[]){for(const t in n){const u=n[t],o=u===null||typeof u!="object",s={parent:n,key:t,value:u,path:i.concat([t]),isLeaf:o,set:m=>Ke(n,t,m)},f=r(s);if(f==="abort")return f;if(f==="skip")continue;if(!o){const m=he(u,r,s.path);if(m==="abort")return m}}}function wn(n,r){return n===r||n.size===r.size&&[...n].every(i=>r.has(i))}function gt(n,r){const i=new Map;function t(s,f){return s instanceof Date&&f instanceof Date&&s.getTime()!==f.getTime()||s instanceof Set&&f instanceof Set&&!wn(s,f)||s instanceof File&&f instanceof File&&s!==f}function u(s){return s instanceof Date||s instanceof Set||s instanceof File}function o(s,f){const m=f?de(f,s.path):void 0;function c(){return i.set(s.path.join(" "),s.path),"skip"}if(u(s.value)&&(!u(m==null?void 0:m.value)||t(s.value,m.value)))return c();s.isLeaf&&(!m||s.value!==m.value)&&c()}return he(n,s=>o(s,r)),he(r,s=>o(s,n)),Array.from(i.values())}function le(n,r,i){const t=typeof i=="function";for(const u of r){const o=de(n,u,({parent:s,key:f,value:m})=>((m===void 0||typeof m!="object")&&(s[f]={}),s[f]));o&&(o.parent[o.key]=t?i(u,o):i)}}function Me(n){return n.toString().split(/[[\].]+/).filter(r=>r)}function Se(n){return n.reduce((r,i)=>{const t=String(i);return typeof i=="number"||/^\d+$/.test(t)?r+=`[${t}]`:r?r+=`.${t}`:r+=t,r},"")}var Sn=Pe;function Pe(n){let r=n;var i={}.toString.call(n).slice(8,-1);if(i=="Set")return new Set([...n].map(u=>Pe(u)));if(i=="Map")return new Map([...n].map(u=>[Pe(u[0]),Pe(u[1])]));if(i=="Date")return new Date(n.getTime());if(i=="RegExp")return RegExp(n.source,Tn(n));if(i=="Array"||i=="Object"){r=Array.isArray(n)?[]:{};for(var t in n)r[t]=Pe(n[t])}return r}function Tn(n){if(typeof n.source.flags=="string")return n.source.flags;var r=[];return n.global&&r.push("g"),n.ignoreCase&&r.push("i"),n.multiline&&r.push("m"),n.sticky&&r.push("y"),n.unicode&&r.push("u"),r.join("")}function W(n){return n&&typeof n=="object"?Sn(n):n}class H extends Error{constructor(r){super(r),Object.setPrototypeOf(this,H.prototype)}}function An(n,r){var u;const i={};function t(o){if("_errors"in i||(i._errors=[]),!Array.isArray(i._errors))if(typeof i._errors=="string")i._errors=[i._errors];else throw new H("Form-level error was not an array.");i._errors.push(o.message)}for(const o of n){if(!o.path||o.path.length==1&&!o.path[0]){t(o);continue}const f=!/^\d$/.test(String(o.path[o.path.length-1]))&&((u=ge(r,o.path.filter(h=>/\D/.test(String(h)))))==null?void 0:u.value),m=de(i,o.path,({value:h,parent:b,key:A})=>(h===void 0&&(b[A]={}),b[A]));if(!m){t(o);continue}const{parent:c,key:p}=m;f?(p in c||(c[p]={}),"_errors"in c[p]?c[p]._errors.push(o.message):c[p]._errors=[o.message]):p in c?c[p].push(o.message):c[p]=[o.message]}return i}function bt(n,r,i){return i?n:(he(r,t=>{Array.isArray(t.value)&&t.set(void 0)}),he(n,t=>{!Array.isArray(t.value)&&t.value!==void 0||le(r,[t.path],t.value)}),r)}function Mn(n){return Pt(n,[])}function Pt(n,r){return Object.entries(n).filter(([,t])=>t!==void 0).flatMap(([t,u])=>{if(Array.isArray(u)&&u.length>0){const o=r.concat([t]);return{path:Se(o),messages:u}}else return Pt(n[t],r.concat([t]))})}function vt(n){!n.flashMessage||!Ot||Xe(n)&&(document.cookie=`flash=; Max-Age=0; Path=${n.flashMessage.cookiePath??"/"};`)}function Xe(n){return!n.flashMessage||!Ot?!1:n.syncFlashMessage}function kn(n){const r=JSON.parse(n);return r.data&&(r.data=cn(r.data)),r}function _t(n){return HTMLElement.prototype.cloneNode.call(n)}function Fn(n,r=()=>{}){const i=async({action:u,result:o,reset:s=!0,invalidateAll:f=!0})=>{o.type==="success"&&(s&&HTMLFormElement.prototype.reset.call(n),f&&await It()),(location.origin+location.pathname===u.origin+u.pathname||o.type==="redirect"||o.type==="error")&&Ve(o)};async function t(u){var P,I,g,O;if(((P=u.submitter)!=null&&P.hasAttribute("formmethod")?u.submitter.formMethod:_t(n).method)!=="post")return;u.preventDefault();const s=new URL((I=u.submitter)!=null&&I.hasAttribute("formaction")?u.submitter.formAction:_t(n).action),f=new FormData(n),m=(g=u.submitter)==null?void 0:g.getAttribute("name");m&&f.append(m,((O=u.submitter)==null?void 0:O.getAttribute("value"))??"");const c=new AbortController;let p=!1;const b=await r({action:s,cancel:()=>p=!0,controller:c,formData:f,formElement:n,submitter:u.submitter})??i;if(p)return;let A;try{const F=await fetch(s,{method:"POST",headers:{accept:"application/json","x-sveltekit-action":"true"},cache:"no-store",body:f,signal:c.signal});A=kn(await F.text()),A.type==="error"&&(A.status=F.status)}catch(F){if((F==null?void 0:F.name)==="AbortError")return;A={type:"error",error:F}}b({action:s,formData:f,formElement:n,update:F=>i({action:s,result:A,reset:F==null?void 0:F.reset,invalidateAll:F==null?void 0:F.invalidateAll}),result:A})}return HTMLFormElement.prototype.addEventListener.call(n,"submit",t),{destroy(){HTMLFormElement.prototype.removeEventListener.call(n,"submit",t)}}}const Dt="noCustomValidity";async function Et(n,r){"setCustomValidity"in n&&n.setCustomValidity(""),!(Dt in n.dataset)&&Ct(n,r)}function In(n,r){for(const i of n.querySelectorAll("input,select,textarea,button")){if(Dt in i.dataset)continue;const t=de(r,Me(i.name));if(Ct(i,t==null?void 0:t.value),t!=null&&t.value)return}}function Ct(n,r){const i=r&&r.length?r.join(`
`):"";n.setCustomValidity(i),i&&n.reportValidity()}const On=(n,r=0)=>{const i=n.getBoundingClientRect();return i.top>=r&&i.left>=0&&i.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&i.right<=(window.innerWidth||document.documentElement.clientWidth)},Pn=(n,r=1.125,i="smooth")=>{const o=n.getBoundingClientRect().top+window.pageYOffset-window.innerHeight/(2*r);window.scrollTo({left:0,top:o,behavior:i})},Dn=["checkbox","radio","range","file"];function wt(n){const r=!!n&&(n instanceof HTMLSelectElement||n instanceof HTMLInputElement&&Dn.includes(n.type)),i=!!n&&n instanceof HTMLSelectElement&&n.multiple,t=!!n&&n instanceof HTMLInputElement&&n.type=="file";return{immediate:r,multiple:i,file:t}}var z;(function(n){n[n.Idle=0]="Idle",n[n.Submitting=1]="Submitting",n[n.Delayed=2]="Delayed",n[n.Timeout=3]="Timeout"})(z||(z={}));const Cn=new Set;function xn(n,r,i){let t=z.Idle,u,o;const s=Cn;function f(){m(),p(t!=z.Delayed?z.Submitting:z.Delayed),u=window.setTimeout(()=>{u&&t==z.Submitting&&p(z.Delayed)},i.delayMs),o=window.setTimeout(()=>{o&&t==z.Delayed&&p(z.Timeout)},i.timeoutMs),s.add(m)}function m(){clearTimeout(u),clearTimeout(o),u=o=0,s.delete(m),p(z.Idle)}function c(){s.forEach(g=>g()),s.clear()}function p(g){t=g,r.submitting.set(t>=z.Submitting),r.delayed.set(t>=z.Delayed),r.timeout.set(t>=z.Timeout)}const h=n;function b(g){const O=g.target;i.selectErrorText&&O.select()}function A(){i.selectErrorText&&h.querySelectorAll("input").forEach(g=>{g.addEventListener("invalid",b)})}function P(){i.selectErrorText&&h.querySelectorAll("input").forEach(g=>g.removeEventListener("invalid",b))}const I=n;{A();const g=O=>{O.clearAll?c():m(),O.cancelled||setTimeout(()=>Ze(I,i),1)};return Le(()=>{P(),g({cancelled:!0})}),{submitting(){f()},completed:g,scrollToFirstError(){setTimeout(()=>Ze(I,i),1)},isSubmitting:()=>t===z.Submitting||t===z.Delayed}}}const Ze=async(n,r)=>{if(r.scrollToError=="off")return;const i=r.errorSelector;if(!i)return;await Ye();let t;if(t=n.querySelector(i),!t)return;t=t.querySelector(i)??t;const u=r.stickyNavbar?document.querySelector(r.stickyNavbar):null;typeof r.scrollToError!="string"?t.scrollIntoView(r.scrollToError):On(t,(u==null?void 0:u.offsetHeight)??0)||Pn(t,void 0,r.scrollToError);function o(f){return typeof r.autoFocusOnError=="boolean"?r.autoFocusOnError:!/iPhone|iPad|iPod|Android/i.test(f)}if(!o(navigator.userAgent))return;let s;if(s=t,["INPUT","SELECT","BUTTON","TEXTAREA"].includes(s.tagName)||(s=s.querySelector('input:not([type="hidden"]):not(.flatpickr-input), select, textarea')),s)try{s.focus({preventScroll:!0}),r.selectErrorText&&s.tagName=="INPUT"&&s.select()}catch{}};function He(n,r,i){const t=de(n,r,({parent:u,key:o,value:s})=>(s===void 0&&(u[o]=/\D/.test(o)?{}:[]),u[o]));if(t){const u=i(t.value);t.parent[t.key]=u}return n}function jn(n,r,i){const t=n.form,u=Me(r),o=et(t,s=>{const f=de(s,u);return f==null?void 0:f.value});return{subscribe(...s){const f=o.subscribe(...s);return()=>f()},update(s,f){t.update(m=>He(m,u,s),f??i)},set(s,f){t.update(m=>He(m,u,()=>s),f??i)}}}function Nn(n,r){const i="form"in n;if(!i&&(r==null?void 0:r.taint)!==void 0)throw new H("If options.taint is set, the whole superForm object must be used as a proxy.");return i}function je(n,r,i){const t=Me(r);if(Nn(n,i))return jn(n,r,i);const u=et(n,o=>{const s=de(o,t);return s==null?void 0:s.value});return{subscribe(...o){const s=u.subscribe(...o);return()=>s()},update(o){n.update(s=>He(s,t,o))},set(o){n.update(s=>He(s,t,()=>o))}}}function Qe(n){let r={};const i=Array.isArray(n);for(const[t,u]of Object.entries(n))!u||typeof u!="object"||(i?r={...r,...Qe(u)}:r[t]=Qe(u));return r}const Ne=new WeakMap,we=new WeakMap,xt=n=>{console.warn("Unhandled error caught by Superforms, use onError event to handle it:",n.result.error)},Ln={applyAction:!0,invalidateAll:!0,resetForm:!0,autoFocusOnError:"detect",scrollToError:"smooth",errorSelector:'[aria-invalid="true"],[data-invalid]',selectErrorText:!1,stickyNavbar:void 0,taintedMessage:!1,onSubmit:void 0,onResult:void 0,onUpdate:void 0,onUpdated:void 0,onError:xt,dataType:"form",validators:void 0,customValidity:!1,clearOnSubmit:"message",delayMs:500,timeoutMs:8e3,multipleSubmits:"prevent",SPA:void 0,validationMethod:"auto"};function Rn(n){return`Duplicate form id's found: "${n}". Multiple forms will receive the same data. Use the id option to differentiate between them, or if this is intended, set the warnings.duplicateId option to false in superForm to disable this warning. More information: https://superforms.rocks/concepts/multiple-forms`}let jt=!1;try{SUPERFORMS_LEGACY&&(jt=!0)}catch{}let Te=!1;try{globalThis.STORIES&&(Te=!0)}catch{}function Vn(n,r){var ft;let i,t={},u;{if((t.legacy??jt)&&(t.resetForm===void 0&&(t.resetForm=!1),t.taintedMessage===void 0&&(t.taintedMessage=!0)),Te&&t.applyAction===void 0&&(t.applyAction=!1),typeof t.SPA=="string"&&(t.invalidateAll===void 0&&(t.invalidateAll=!1),t.applyAction===void 0&&(t.applyAction=!1)),u=t.validators,t={...Ln,...t},(t.SPA===!0||typeof t.SPA=="object")&&t.validators===void 0&&console.warn("No validators set for superForm in SPA mode. Add a validation adapter to the validators option, or set it to false to disable this warning."),!n)throw new H("No form data sent to superForm. Make sure the output from superValidate is used (usually data.form) and that it's not null or undefined. Alternatively, an object with default values for the form can also be used, but then constraints won't be available.");c(n)===!1&&(n={id:t.id??Math.random().toString(36).slice(2,10),valid:!1,posted:!1,errors:{},data:n,shape:Qe(n)}),n=n;const e=n.id=t.id??n.id,a=Ie(Oe)??(Te?{}:void 0);if(((ft=t.warnings)==null?void 0:ft.duplicateId)!==!1)if(!Ne.has(a))Ne.set(a,new Set([e]));else{const l=Ne.get(a);l!=null&&l.has(e)?console.warn(Rn(e)):l==null||l.add(e)}if(we.has(n)||we.set(n,n),i=we.get(n),n=W(i),Le(()=>{var l;zt(),Rt(),Yt();for(const d of Object.values(re))d.length=0;(l=Ne.get(a))==null||l.delete(e)}),t.dataType!=="json"){const l=(d,y)=>{if(!(!y||typeof y!="object")){if(Array.isArray(y))y.length>0&&l(d,y[0]);else if(!(y instanceof Date)&&!(y instanceof File)&&!(y instanceof FileList))throw new H(`Object found in form field "${d}". Set the dataType option to "json" and add use:enhance to use nested data structures. More information: https://superforms.rocks/concepts/nested-data`)}};for(const[d,y]of Object.entries(n.data))l(d,y)}}const o={formId:n.id,form:W(n.data),constraints:n.constraints??{},posted:n.posted,errors:W(n.errors),message:W(n.message),tainted:void 0,valid:n.valid,submitting:!1,shape:n.shape},s=o,f=oe(t.id??n.id);function m(e){return Object.values(e).filter(l=>c(l)!==!1)}function c(e){return!e||typeof e!="object"||!("valid"in e&&"errors"in e&&typeof e.valid=="boolean")?!1:"id"in e&&typeof e.id=="string"?e.id:!1}const p=oe(n.data),h={subscribe:p.subscribe,set:(e,a={})=>{const l=W(e);return it(l,a.taint??!0),p.set(l)},update:(e,a={})=>p.update(l=>{const d=e(l);return it(d,a.taint??!0),d})};function b(){return t.SPA===!0||typeof t.SPA=="object"}async function A(e={}){const a=e.formData??s.form;let l={},d;const y=e.adapter??t.validators;if(typeof y=="object"){if(y!=u&&!("jsonSchema"in y))throw new H('Client validation adapter found in options.validators. A full adapter must be used when changing validators dynamically, for example "zod" instead of "zodClient".');if(d=await y.validate(a),!d.success)l=An(d.issues,y.shape??s.shape??{});else if(e.recheckValidData!==!1)return A({...e,recheckValidData:!1})}else d={success:!0,data:{}};const v={...s.form,...a,...d.success?d.data:{}};return{valid:d.success,posted:!1,errors:l,data:v,constraints:s.constraints,message:void 0,id:s.formId,shape:s.shape}}function P(e){if(!t.onChange||!e.paths.length||e.type=="blur")return;let a;const l=e.paths.map(Se);e.type&&e.paths.length==1&&e.formElement&&e.target instanceof Element?a={path:l[0],paths:l,formElement:e.formElement,target:e.target,set(d,y,v){je({form:h},d,v).set(y)},get(d){return Ie(je(h,d))}}:a={paths:l,target:void 0,set(d,y,v){je({form:h},d,v).set(y)},get(d){return Ie(je(h,d))}},t.onChange(a)}async function I(e,a=!1,l){e&&(t.validators=="clear"&&ne.update(v=>(le(v,e.paths,void 0),v)),setTimeout(()=>P(e)));let d=!1;if(a||(t.validationMethod=="onsubmit"||t.validationMethod=="submit-only"||t.validationMethod=="onblur"&&(e==null?void 0:e.type)=="input"||t.validationMethod=="oninput"&&(e==null?void 0:e.type)=="blur")&&(d=!0),d||!e||!t.validators||t.validators=="clear"){if(e!=null&&e.paths){const v=(e==null?void 0:e.formElement)??ke();v&&g(v,e.paths)}return}const y=await A({adapter:l});return y.valid&&(e.immediate||e.type!="input")&&h.set(y.data,{taint:"ignore"}),await Ye(),O(y.errors,e,a),y}function g(e,a){const l=new Map;if(t.customValidity&&e)for(const d of a){const y=CSS.escape(Se(d)),v=e.querySelector(`[name="${y}"]`);if(v){const B="validationMessage"in v?String(v.validationMessage):"";l.set(d.join("."),{el:v,message:B}),Et(v,void 0)}}return l}async function O(e,a,l){const{type:d,immediate:y,multiple:v,paths:B}=a,ae=s.errors,N={};let se=new Map;const X=a.formElement??ke();X&&(se=g(X,a.paths)),he(e,Y=>{if(!Array.isArray(Y.value))return;const Z=[...Y.path];Z[Z.length-1]=="_errors"&&Z.pop();const Ee=Z.join(".");function pe(){if(le(N,[Y.path],Y.value),t.customValidity&&be&&se.has(Ee)){const{el:_,message:w}=se.get(Ee);w!=Y.value&&(Et(_,Y.value),se.clear())}}if(l)return pe();const xe=Y.path[Y.path.length-1]=="_errors",be=Y.value&&B.some(_=>xe?Z&&_&&Z.length>0&&Z[0]==_[0]:Ee==_.join("."));if(be&&t.validationMethod=="oninput"||y&&!v&&be)return pe();if(v){const _=ge(Ie(ne),Y.path.slice(0,-1));if(_!=null&&_.value&&typeof(_==null?void 0:_.value)=="object"){for(const w of Object.values(_.value))if(Array.isArray(w))return pe()}}const k=ge(ae,Y.path);if(k&&k.key in k.parent)return pe();if(xe){if(t.validationMethod=="oninput"||d=="blur"&&$t(Se(Y.path.slice(0,-1))))return pe()}else if(d=="blur"&&be)return pe()}),ne.set(N)}function F(e,a={}){return a.keepFiles&&he(s.form,l=>{if(!(l.parent instanceof FileList)&&(l.value instanceof File||l.value instanceof FileList)){const d=ge(e,l.path);(!d||!(d.key in d.parent))&&le(e,[l.path],l.value)}}),h.set(e,a)}function ie(e,a){return e&&a&&t.resetForm&&(t.resetForm===!0||t.resetForm())}async function T(e,a){e.valid&&a&&ie(e.valid,a)?E({message:e.message,posted:!0}):Ce({form:e,untaint:a,keepFiles:!0,skipFormData:t.invalidateAll=="force"}),re.onUpdated.length&&await Ye();for(const l of re.onUpdated)l({form:e})}function E(e={}){e.newState&&(i.data={...i.data,...e.newState});const a=W(i);a.data={...a.data,...e.data},e.id!==void 0&&(a.id=e.id),Ce({form:a,untaint:!0,message:e.message,keepFiles:!1,posted:e.posted,resetted:!0})}async function C(e){if(e.type=="error")throw new H(`ActionResult of type "${e.type}" cannot be passed to update function.`);if(e.type=="redirect"){ie(!0,!0)&&E({posted:!0});return}if(typeof e.data!="object")throw new H("Non-object validation data returned from ActionResult.");const a=m(e.data);if(!a.length)throw new H("No form data returned from ActionResult. Make sure you return { form } in the form actions.");for(const l of a)l.id===s.formId&&await T(l,e.status>=200&&e.status<300)}const D=oe(o.message),te=oe(o.constraints),K=oe(o.posted),me=oe(o.shape),$e=oe(n.errors),ne={subscribe:$e.subscribe,set(e,a){return $e.set(bt(e,s.errors,a==null?void 0:a.force))},update(e,a){return $e.update(l=>bt(e(l),s.errors,a==null?void 0:a.force))},clear:()=>ne.set({})};let j=null;function Nt(e){var a;j&&e&&Object.keys(e).length==1&&((a=e.paths)!=null&&a.length)&&j.target&&j.target instanceof HTMLInputElement&&j.target.type.toLowerCase()=="file"?j.paths=e.paths:j=e,setTimeout(()=>{I(j)},0)}function Lt(e,a,l,d,y){j===null&&(j={paths:[]}),j.type=e,j.immediate=a,j.multiple=l,j.formElement=d,j.target=y}function tt(){return(j==null?void 0:j.paths)??[]}function Rt(){j=null}const $={defaultMessage:"Leave page? Changes that you made may not be saved.",state:oe(),message:t.taintedMessage,clean:W(n.data),forceRedirection:!1};function nt(){return t.taintedMessage&&!s.submitting&&!$.forceRedirection&&at()}function rt(e){if(!nt())return;e.preventDefault(),e.returnValue="";const{taintedMessage:a}=t,d=typeof a=="function"||a===!0?$.defaultMessage:a;return(e||window.event).returnValue=d||$.defaultMessage,d}async function Vt(e){if(!nt())return;const{taintedMessage:a}=t,l=typeof a=="function";if(l&&e.cancel(),e.type==="leave")return;const d=l||a===!0?$.defaultMessage:a;let y;try{y=l?await a():window.confirm(d||$.defaultMessage)}catch{y=!1}if(y&&e.to)try{$.forceRedirection=!0,await mn(e.to.url,{...e.to.params});return}finally{$.forceRedirection=!1}else!y&&!l&&e.cancel()}function Ht(){t.taintedMessage=$.message}function Ut(){return $.state}function $t(e){if(!s.tainted)return!1;if(!e)return!!s.tainted;const a=ge(s.tainted,Me(e));return!!a&&a.key in a.parent}function at(e){if(typeof e=="boolean")return e;if(typeof e=="object")return De(e);if(!s.tainted)return!1;if(!e)return De(s.tainted);const a=ge(s.tainted,Me(e));return De(a==null?void 0:a.value)}function De(e){if(!e)return!1;if(typeof e=="object"){for(const a of Object.values(e))if(De(a))return!0}return e===!0}function it(e,a){if(a=="ignore")return;const l=gt(e,s.form),d=gt(e,$.clean).map(y=>y.join());l.length&&(a=="untaint-all"||a=="untaint-form"?$.state.set(void 0):$.state.update(y=>(y||(y={}),le(y,l,(v,B)=>{if(!d.includes(v.join()))return;const ae=de(e,v),N=de($.clean,v);return ae&&N&&ae.value===N.value?void 0:a===!0?!0:a==="untaint"?void 0:B.value}),y))),Nt({paths:l})}function Bt(e,a){$.state.set(e),a&&($.clean=a)}const Be=oe(!1),st=oe(!1),ot=oe(!1),ut=[$.state.subscribe(e=>o.tainted=W(e)),h.subscribe(e=>o.form=W(e)),ne.subscribe(e=>o.errors=W(e)),f.subscribe(e=>o.formId=e),te.subscribe(e=>o.constraints=e),K.subscribe(e=>o.posted=e),D.subscribe(e=>o.message=e),Be.subscribe(e=>o.submitting=e),me.subscribe(e=>o.shape=e)];function qt(e){ut.push(e)}function zt(){ut.forEach(e=>e())}let J;function ke(){return J}function Gt(e){J=document.createElement("form"),J.method="POST",J.action=e,lt(J),document.body.appendChild(J)}function Jt(e){J&&(J.action=e)}function Yt(){J!=null&&J.parentElement&&J.remove(),J=void 0}const Wt=et(ne,e=>e?Mn(e):[]);t.taintedMessage=void 0;function Ce(e){const a=e.form,l=e.message??a.message;if((e.untaint||e.resetted)&&Bt(typeof e.untaint=="boolean"?void 0:e.untaint,a.data),e.skipFormData!==!0&&F(a.data,{taint:"ignore",keepFiles:e.keepFiles}),D.set(l),e.resetted?ne.update(()=>({}),{force:!0}):ne.set(a.errors),f.set(a.id),K.set(e.posted??a.posted),a.constraints&&te.set(a.constraints),a.shape&&me.set(a.shape),o.valid=a.valid,t.flashMessage&&Xe(t)){const d=t.flashMessage.module.getFlash(Oe);l&&Ie(d)===void 0&&d.set(l)}}const re={onSubmit:t.onSubmit?[t.onSubmit]:[],onResult:t.onResult?[t.onResult]:[],onUpdate:t.onUpdate?[t.onUpdate]:[],onUpdated:t.onUpdated?[t.onUpdated]:[],onError:t.onError?[t.onError]:[]};window.addEventListener("beforeunload",rt),Le(()=>{window.removeEventListener("beforeunload",rt)}),dn(Vt),qt(Oe.subscribe(async e=>{Te&&e===void 0&&(e={status:200});const a=e.status>=200&&e.status<300;if(t.applyAction&&e.form&&typeof e.form=="object"){const l=e.form;if(l.type=="error")return;for(const d of m(l)){const y=we.has(d);d.id!==s.formId||y||(we.set(d,d),await T(d,a))}}else if(e.data&&typeof e.data=="object")for(const l of m(e.data)){const d=we.has(l);if(l.id!==s.formId||d)continue;t.invalidateAll==="force"&&(i.data=l.data);const y=ie(!0,!0);Ce({form:l,untaint:a,keepFiles:!y,resetted:y})}})),typeof t.SPA=="string"&&Gt(t.SPA);function lt(e,a){if(t.SPA!==void 0&&e.method=="get"&&(e.method="post"),typeof t.SPA=="string"?t.SPA.length&&e.action==document.location.href&&(e.action=t.SPA):J=e,a){if(a.onError){if(t.onError==="apply")throw new H('options.onError is set to "apply", cannot add any onError events.');if(a.onError==="apply")throw new H('Cannot add "apply" as onError event in use:enhance.');re.onError.push(a.onError)}a.onResult&&re.onResult.push(a.onResult),a.onSubmit&&re.onSubmit.push(a.onSubmit),a.onUpdate&&re.onUpdate.push(a.onUpdate),a.onUpdated&&re.onUpdated.push(a.onUpdated)}Ht();let l;async function d(ae){const N=wt(ae.target);N.immediate&&!N.file&&await new Promise(se=>setTimeout(se,0)),l=tt(),Lt("input",N.immediate,N.multiple,e,ae.target??void 0)}async function y(ae){if(s.submitting||!l||tt()!=l)return;const N=wt(ae.target);N.immediate&&!N.file&&await new Promise(se=>setTimeout(se,0)),I({paths:l,immediate:N.multiple,multiple:N.multiple,type:"blur",formElement:e,target:ae.target??void 0}),l=void 0}e.addEventListener("focusout",y),e.addEventListener("input",d),Le(()=>{e.removeEventListener("focusout",y),e.removeEventListener("input",d)});const v=xn(e,{submitting:Be,delayed:st,timeout:ot},t);let B;return Fn(e,async ae=>{let N,se=t.validators;const X={...ae,jsonData(k){if(t.dataType!=="json")throw new H("options.dataType must be set to 'json' to use jsonData.");N=k},validators(k){se=k}},Y=X.cancel;let Z=!1;function Ee(k){var ue;const _={...k,posted:!0},w=_.valid?200:(typeof t.SPA=="boolean"||typeof t.SPA=="string"||(ue=t.SPA)==null?void 0:ue.failStatus)??400,q={form:_},G=_.valid?{type:"success",status:w,data:q}:{type:"failure",status:w,data:q};setTimeout(()=>be({result:G}),0)}function pe(){switch(t.clearOnSubmit){case"errors-and-message":ne.clear(),D.set(void 0);break;case"errors":ne.clear();break;case"message":D.set(void 0);break}}function Fe(k={resetTimers:!0}){return Z=!0,k.resetTimers&&v.isSubmitting()&&v.completed({cancelled:Z}),Y()}if(X.cancel=Fe,v.isSubmitting()&&t.multipleSubmits=="prevent")Fe({resetTimers:!1});else{v.isSubmitting()&&t.multipleSubmits=="abort"&&B&&B.abort(),v.submitting(),B=X.controller;for(const k of re.onSubmit)await k(X)}if(Z&&t.flashMessage&&vt(t),!Z){const k=!b()&&(e.noValidate||(X.submitter instanceof HTMLButtonElement||X.submitter instanceof HTMLInputElement)&&X.submitter.formNoValidate);let _;const w=async()=>await A({adapter:se});if(pe(),k||(_=await w(),_.valid||(Fe({resetTimers:!1}),Ee(_))),!Z){t.flashMessage&&(t.clearOnSubmit=="errors-and-message"||t.clearOnSubmit=="message")&&Xe(t)&&t.flashMessage.module.getFlash(Oe).set(void 0);const q="formData"in X?X.formData:X.data;if(l=void 0,b())_||(_=await w()),Fe({resetTimers:!1}),Ee(_);else if(t.dataType==="json"){_||(_=await w());const G=W(N??_.data);he(G,L=>{if(L.value instanceof File){const x="__superform_file_"+Se(L.path);return q.append(x,L.value),L.set(void 0)}else if(Array.isArray(L.value)&&L.value.length&&L.value.every(x=>x instanceof File)){const x="__superform_files_"+Se(L.path);for(const Q of L.value)q.append(x,Q);return L.set(void 0)}}),Object.keys(G).forEach(L=>{typeof q.get(L)=="string"&&q.delete(L)});const ue=xe(_n(G),t.jsonChunkSize??5e5);for(const L of ue)q.append("__superform_json",L)}if(!q.has("__superform_id")){const G=s.formId;G!==void 0&&q.set("__superform_id",G)}typeof t.SPA=="string"&&Jt(t.SPA)}}function xe(k,_){const w=Math.ceil(k.length/_),q=new Array(w);for(let G=0,ue=0;G<w;++G,ue+=_)q[G]=k.substring(ue,ue+_);return q}async function be(k){var L;let _=!1;B=null;let w="type"in k.result&&"status"in k.result?k.result:{type:"error",status:parseInt(String(k.result.status))||500,error:k.result.error instanceof Error?k.result.error:k.result};const q=()=>_=!0,G={result:w,formEl:e,formElement:e,cancel:q},ue=Te||!b()?()=>{}:ht.subscribe(x=>{var Q,ye;!x||((Q=x.from)==null?void 0:Q.route.id)===((ye=x.to)==null?void 0:ye.route.id)||q()});for(const x of re.onResult)await x(G);if(w=G.result,!_){if((w.type==="success"||w.type=="failure")&&w.data){const x=m(w.data);if(!x.length)throw new H("No form data returned from ActionResult. Make sure you return { form } in the form actions.");for(const Q of x){if(Q.id!==s.formId)continue;const ye={form:Q,formEl:e,formElement:e,cancel:()=>_=!0,result:w};for(const qe of re.onUpdate)await qe(ye);w=ye.result,_||(t.customValidity&&In(e,ye.form.errors),ie(ye.form.valid,w.type=="success")&&ye.formElement.querySelectorAll('input[type="file"]').forEach(qe=>qe.value=""))}}if(!_){if(w.type!=="error")w.type==="success"&&t.invalidateAll&&await It(),t.applyAction?await Ve(w):await C(w);else{if(t.applyAction)if(t.onError=="apply")await Ve(w);else{const x={type:"failure",status:Math.floor(w.status||500),data:w};await Ve(x)}if(t.onError!=="apply"){const x={result:w,message:D};for(const Q of re.onError)Q!=="apply"&&(Q!=xt||!((L=t.flashMessage)!=null&&L.onError))&&await Q(x)}}t.flashMessage&&w.type=="error"&&t.flashMessage.onError&&await t.flashMessage.onError({result:w,flashMessage:t.flashMessage.module.getFlash(Oe)})}}if(_&&t.flashMessage&&vt(t),_||w.type!="redirect")v.completed({cancelled:_});else if(Te)v.completed({cancelled:_,clearAll:!0});else{const x=ht.subscribe(Q=>{Q||(setTimeout(()=>{try{x&&x()}catch{}}),v.isSubmitting()&&v.completed({cancelled:_,clearAll:!0}))})}ue()}return be})}function Kt(e){const a=[];if(he(e,d=>{if(d.value instanceof File)return a.push(d.path),"skip";if(Array.isArray(d.value)&&d.value.length&&d.value.every(y=>y instanceof File))return a.push(d.path),"skip"}),!a.length)return{data:e,paths:a};const l=W(e);return le(l,a,d=>{var y;return(y=ge(i.data,d))==null?void 0:y.value}),{data:l,paths:a}}return{form:h,formId:f,errors:ne,message:D,constraints:te,tainted:Ut(),submitting:ze(Be),delayed:ze(st),timeout:ze(ot),options:t,capture(){const{data:e,paths:a}=Kt(s.form);let l=s.tainted;return a.length&&(l=W(l)??{},le(l,a,!1)),{valid:s.valid,posted:s.posted,errors:s.errors,data:e,constraints:s.constraints,message:s.message,id:s.formId,tainted:l,shape:s.shape}},restore:e=>{Ce({form:e,untaint:e.tainted??!0})},async validate(e,a={}){if(!t.validators)throw new H("options.validators must be set to use the validate method.");a.update===void 0&&(a.update=!0),a.taint===void 0&&(a.taint=!1),typeof a.errors=="string"&&(a.errors=[a.errors]);let l;const d=Me(e);"value"in a?a.update===!0||a.update==="value"?(h.update(B=>(le(B,[d],a.value),B),{taint:a.taint}),l=s.form):(l=W(s.form),le(l,[d],a.value)):l=s.form;const y=await A({formData:l}),v=ge(y.errors,d);return v&&v.value&&a.errors&&(v.value=a.errors),(a.update===!0||a.update=="errors")&&ne.update(B=>(le(B,[d],v==null?void 0:v.value),B)),v==null?void 0:v.value},async validateForm(e={}){if(!t.validators&&!e.schema)throw new H("options.validators or the schema option must be set to use the validateForm method.");const a=e.update?await I({paths:[]},!0,e.schema):A({adapter:e.schema}),l=ke();return e.update&&l&&setTimeout(()=>{l&&Ze(l,{...t,scrollToError:e.focusOnError===!1?"off":t.scrollToError})},1),a||A({adapter:e.schema})},allErrors:Wt,posted:K,reset(e){return E({message:e!=null&&e.keepMessage?s.message:void 0,data:e==null?void 0:e.data,id:e==null?void 0:e.id,newState:e==null?void 0:e.newState})},submit(e){const a=ke()?ke():e&&e instanceof HTMLElement?e.closest("form"):void 0;if(!a)throw new H("use:enhance must be added to the form to use submit, or pass a HTMLElement inside the form (or the form itself) as an argument.");if(!a.requestSubmit)return a.submit();const l=e&&(e instanceof HTMLButtonElement&&e.type=="submit"||e instanceof HTMLInputElement&&["submit","image"].includes(e.type));a.requestSubmit(l?e:void 0)},isTainted:at,enhance:lt}}new TextEncoder;let Hn=!1;try{SUPERFORMS_LEGACY&&(Hn=!0)}catch{}function St(n,r,i){const t=n.slice();return t[9]=r[i],t}function Tt(n){let r,i=n[2].name+"",t;return{c(){r=R("span"),t=ve(i),this.h()},l(u){r=V(u,"SPAN",{class:!0});var o=ee(r);t=_e(o,i),o.forEach(U),this.h()},h(){M(r,"class","invalid bg-error-700")},m(u,o){Ue(u,r,o),S(r,t)},p(u,o){o&4&&i!==(i=u[2].name+"")&&We(t,i)},d(u){u&&U(r)}}}function At(n){let r,i,t="Current Games",u,o,s=pt(n[0].games),f=[];for(let m=0;m<s.length;m+=1)f[m]=Mt(St(n,s,m));return{c(){r=R("div"),i=R("h2"),i.textContent=t,u=fe(),o=R("div");for(let m=0;m<f.length;m+=1)f[m].c();this.h()},l(m){r=V(m,"DIV",{class:!0});var c=ee(r);i=V(c,"H2",{class:!0,"data-svelte-h":!0}),Re(i)!=="svelte-1oodst0"&&(i.textContent=t),u=ce(c),o=V(c,"DIV",{class:!0});var p=ee(o);for(let h=0;h<f.length;h+=1)f[h].l(p);p.forEach(U),c.forEach(U),this.h()},h(){M(i,"class","h2 text-center bg-zinc-800 py-3"),M(o,"class","flex flex-col gap-4"),M(r,"class","bg-zinc-800")},m(m,c){Ue(m,r,c),S(r,i),S(r,u),S(r,o);for(let p=0;p<f.length;p+=1)f[p]&&f[p].m(o,null)},p(m,c){if(c&1){s=pt(m[0].games);let p;for(p=0;p<s.length;p+=1){const h=St(m,s,p);f[p]?f[p].p(h,c):(f[p]=Mt(h),f[p].c(),f[p].m(o,null))}for(;p<f.length;p+=1)f[p].d(1);f.length=s.length}},d(m){m&&U(r),an(f,m)}}}function Mt(n){let r,i,t,u=n[9].name+"",o,s,f,m=(n[9].player_ids??0)+"",c,p,h,b,A,P,I,g,O,F,ie;return{c(){r=R("div"),i=R("div"),t=R("h4"),o=ve(u),s=fe(),f=R("p"),c=ve(m),p=ve(" Players"),h=fe(),b=R("a"),A=ve("Join Game"),I=fe(),g=R("a"),O=ve("Admin Join"),ie=fe(),this.h()},l(T){r=V(T,"DIV",{class:!0});var E=ee(r);i=V(E,"DIV",{});var C=ee(i);t=V(C,"H4",{class:!0});var D=ee(t);o=_e(D,u),D.forEach(U),s=ce(C),f=V(C,"P",{class:!0});var te=ee(f);c=_e(te,m),p=_e(te," Players"),te.forEach(U),C.forEach(U),h=ce(E),b=V(E,"A",{class:!0,href:!0,rel:!0});var K=ee(b);A=_e(K,"Join Game"),K.forEach(U),I=ce(E),g=V(E,"A",{class:!0,href:!0,rel:!0});var me=ee(g);O=_e(me,"Admin Join"),me.forEach(U),ie=ce(E),E.forEach(U),this.h()},h(){M(t,"class","h4"),M(f,"class","text-md"),M(b,"class","btn btn-sm variant-glass-primary"),M(b,"href",P=`games/${n[9].id}/join`),M(b,"rel","noreferrer"),M(g,"class","btn btn-sm variant-glass-primary"),M(g,"href",F=`games/${n[9].id}/admin`),M(g,"rel","noreferrer"),M(r,"class","flex flex-col gap-1 text-center")},m(T,E){Ue(T,r,E),S(r,i),S(i,t),S(t,o),S(i,s),S(i,f),S(f,c),S(f,p),S(r,h),S(r,b),S(b,A),S(r,I),S(r,g),S(g,O),S(r,ie)},p(T,E){E&1&&u!==(u=T[9].name+"")&&We(o,u),E&1&&m!==(m=(T[9].player_ids??0)+"")&&We(c,m),E&1&&P!==(P=`games/${T[9].id}/join`)&&M(b,"href",P),E&1&&F!==(F=`games/${T[9].id}/admin`)&&M(g,"href",F)},d(T){T&&U(r)}}}function Un(n){let r,i,t="Masque Royale",u,o,s,f="New Game",m,c,p,h,b,A,P,I,g="Submit",O,F,ie,T=n[2].name&&Tt(n),E=n[0].games&&At(n);return{c(){r=R("section"),i=R("h1"),i.textContent=t,u=fe(),o=R("div"),s=R("h2"),s.textContent=f,m=fe(),c=R("form"),p=R("label"),h=ve(`Name
				`),b=R("input"),A=fe(),T&&T.c(),P=fe(),I=R("button"),I.textContent=g,O=fe(),E&&E.c(),this.h()},l(C){r=V(C,"SECTION",{class:!0});var D=ee(r);i=V(D,"H1",{class:!0,"data-svelte-h":!0}),Re(i)!=="svelte-1q68r41"&&(i.textContent=t),u=ce(D),o=V(D,"DIV",{class:!0});var te=ee(o);s=V(te,"H2",{class:!0,"data-svelte-h":!0}),Re(s)!=="svelte-1wgmtvy"&&(s.textContent=f),m=ce(te),c=V(te,"FORM",{class:!0,method:!0});var K=ee(c);p=V(K,"LABEL",{class:!0,for:!0});var me=ee(p);h=_e(me,`Name
				`),b=V(me,"INPUT",{class:!0,type:!0,name:!0}),me.forEach(U),A=ce(K),T&&T.l(K),P=ce(K),I=V(K,"BUTTON",{class:!0,"data-svelte-h":!0}),Re(I)!=="svelte-1vk1606"&&(I.textContent=g),K.forEach(U),te.forEach(U),O=ce(D),E&&E.l(D),D.forEach(U),this.h()},h(){M(i,"class","h1 text-6xl text-center"),M(s,"class","h2 text-center"),M(b,"class","input"),M(b,"type","text"),M(b,"name","name"),M(p,"class","label"),M(p,"for","name"),M(I,"class","btn btn-lg variant-glass-primary"),M(c,"class","flex flex-col"),M(c,"method","POST"),M(o,"class","bg-zinc-800 p-4 text-token"),M(r,"class","container h-full mx-auto flex flex-col gap-4 px-4 sm:px-0")},m(C,D){Ue(C,r,D),S(r,i),S(r,u),S(r,o),S(o,s),S(o,m),S(o,c),S(c,p),S(p,h),S(p,b),mt(b,n[1].name),S(c,A),T&&T.m(c,null),S(c,P),S(c,I),S(r,O),E&&E.m(r,null),F||(ie=[rn(b,"input",n[7]),Zt(n[5].call(null,c))],F=!0)},p(C,[D]){D&2&&b.value!==C[1].name&&mt(b,C[1].name),C[2].name?T?T.p(C,D):(T=Tt(C),T.c(),T.m(c,P)):T&&(T.d(1),T=null),C[0].games?E?E.p(C,D):(E=At(C),E.c(),E.m(r,null)):E&&(E.d(1),E=null)},i:ct,o:ct,d(C){C&&U(r),T&&T.d(),E&&E.d(),F=!1,Qt(ie)}}}function $n(n,r,i){let t,u,{data:o}=r,{actData:s}=r;const f=sn();en(()=>{o.error&&f.trigger({message:o.error})});const{form:m,errors:c,enhance:p}=Vn(o.form);dt(n,m,b=>i(1,t=b)),dt(n,c,b=>i(2,u=b));function h(){t.name=this.value,m.set(t)}return n.$$set=b=>{"data"in b&&i(0,o=b.data),"actData"in b&&i(6,s=b.actData)},[o,t,u,m,c,p,s,h]}class Kn extends tn{constructor(r){super(),nn(this,r,$n,Un,Xt,{data:0,actData:6})}}export{Kn as component};
